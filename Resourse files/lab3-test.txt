import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.Statement;
import java.util.Scanner;
import java.sql.PreparedStatement;
import java.sql.CallableStatement;
import java.sql.ResultSet;
import java.sql.SQLException;


public class testqlsv {

	public static void main(String[] args) {
		Connection conn = null;
		Statement stml = null;
		ResultSet rs = null;
		
		try {
			Class.forName("com.mysql.cj.jdbc.Driver").newInstance();
			String connStr = "jdbc:mysql://localhost/qldiem?user=contempt&password=123";
			conn = DriverManager.getConnection(connStr);
			System.out.println("Connected!");
			
			try {
				stml = conn.createStatement();
				String sql = "Select * from sinhvien";
				rs = stml.executeQuery(sql);
				System.out.println("Query executed!");
				
				System.out.println("-----List of student-----");
				while(rs.next()) {
					System.out.println("ID: " + rs.getString("mssv")); 
					System.out.println("Name: " + rs.getString("hoten"));
					System.out.println("Dept: " + rs.getString("makhoa"));
					System.out.println("------------------------------");
				}
				
				
				Scanner sc = new Scanner(System.in);
				System.out.print("ENTER student ID: ");
				String mssv = sc.nextLine();
				sql = "Select * from sinhvien join khoa on sinhvien.makhoa = khoa.makhoa" + 
						"Where mssv='" + mssv +"'";
				rs = stml.executeQuery(sql);
				System.out.println("-----List of student (2)-----");
				while(rs.next()) {
					System.out.println("ID: " + rs.getString("mssv")); 
					System.out.println("Name: " + rs.getString("hoten"));
					System.out.println("Dept: " + rs.getString("makhoa"));
					System.out.println("------------------------------");
				}
			}catch(SQLException a) {
				System.out.println("[ERROR]: " + a.getMessage());
			}
			
			
			
		}
		catch(Exception e) {
			System.out.println("Cannot connect: " + e.getMessage());
		}
	}
}
